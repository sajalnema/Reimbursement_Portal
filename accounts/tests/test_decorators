from django.test import TestCase, Client
from django.urls import reverse
from accounts.decorators import user_is_employee
from django.contrib.auth import get_user_model
from accounts.models import Department, CustomUser

User = get_user_model()

class UserIsEmployeeDecoratorTests(TestCase):

    def setUp(self):
        self.client = Client()
        self.department = Department.objects.create(name="HR")
        self.user = CustomUser.objects.create_user(
            username="testuser",
            email="testuser@nucleusteq.com",
            password="password123",
            department=self.department,
            is_employee=True
        )

    def test_user_is_employee_decorator(self):
        self.client.login(username="testuser", password="password123")
        response = self.client.get(reverse('some_view_that_uses_decorator'))
        self.assertEqual(response.status_code, 200)
